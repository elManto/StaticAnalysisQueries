// This script shows all the checks of type "size < N" computed over the `memcpy` size params
// to discover if an unchecked/wrongly checked memcpy exists

@main def execute(payload: String) = {
	importCpg(payload)
	
	def checks = cpg.method.name("<operator>.lessThan").parameter.argument.whereNot(_.isLiteral)
	def sizes = cpg.method.name("memcpy").parameter.argument.filter(_.argumentIndex == 3)
	
	sizes.reachableByFlows(checks).p
	//sizes.reachableBy(checks).count.p
}

