// This script shows all the checks of type (>, <, ...) computed over the `memcpy` input params
// We would expect some check over `destsz` or the `src` buffer -> Missing Check

importCpg("cpg.bin")
val arguments = cpg.method.name("memcpy").parameter.argument

val defs1 = cpg.method.name("memcpy").parameter.argument.reachableBy(cpg.identifier).toSet
//val defs2 = cpg.method.name(".*less.*", ".*greater*." ).parameter.argument.reachableBy(cpg.identifier).toSet
val defs2 = cpg.method.name(".*less.*", ".*greater*." ).parameter.argument.reachableBy(defs1).toSet
defs1.intersect(defs2).asInstanceOf[Set[Call]].foreach(elem => println(elem.code, elem.lineNumber))

