// This script collects all the checks executed over the `strcpy` src param 
// to discover if an unchecked/wrongly-checked strcpy exists

@main def execute(payload: String) = {
	importCpg(payload)
	
	def checks = cpg.method.name("<operator>.lessThan").parameter.argument.whereNot(_.isLiteral)
	def sizes = cpg.method.name("strcpy").parameter.argument.filter(_.argumentIndex == 2)
	
	sizes.reachableByFlows(checks).p
	//sizes.reachableBy(checks).count.p
}

