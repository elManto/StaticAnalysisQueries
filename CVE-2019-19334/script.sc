// This script shows all the checks of type (>, <, ...) computed over the `strcpy` input params
// We would expect some check over `buf` or the `value` buffers -> Missing Check, the script will produce an empty result

importCpg("cpg.bin")
val arguments = cpg.method.name("strcpy").parameter.argument

val defs1 = cpg.method.name("strcpy").parameter.argument.reachableBy(cpg.identifier).l
//val defs2 = cpg.method.name(".*less.*", ".*greater*." ).parameter.argument.reachableBy(cpg.identifier).toSet
val defs2 = cpg.method.name(".*less.*", ".*greater*." ).parameter.argument.reachableBy(defs1).toSet
cpg.method.name("strcpy").parameter.argument.foreach(elem => println("Strcpy at line: ", elem.lineNumber, "is reachable by this checks", elem.reachableBy(defs2).code ))

